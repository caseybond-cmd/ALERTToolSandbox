<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALERT Nursing Risk Assessment Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="p-4 sm:p-6 md:p-8">

    <!-- Launch Screen -->
    <div id="launchScreenModal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex flex-col items-center justify-center p-4 z-50 no-print">
        <div class="bg-white rounded-xl shadow-2xl p-6 md:p-8 text-center max-w-lg w-full space-y-4">
            <h2 class="text-2xl md:text-3xl font-bold text-teal-700">ALERT Tool</h2>
            <p class="text-gray-600">Please choose how you'd like to begin.</p>
            <div class="flex flex-col gap-4 pt-4">
                <button id="startFullReviewBtn" class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 px-6 rounded-lg text-lg">âž• Start New Full Review</button>
                <button id="startQuickScoreBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-6 rounded-lg text-lg">âš¡ Start Quick Score Only</button>
                <div>
                    <button id="resumeReviewBtn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg text-lg">ðŸ“² Continue from Desktop</button>
                    <p class="text-xs text-gray-500 mt-1">(For loading notes you copied from another device)</p>
                </div>
            </div>
            <div id="pasteContainer" class="hidden mt-4">
                <textarea id="pasteDataInput" class="w-full h-24 p-2 border rounded-md" placeholder="Paste your bedside notes here..."></textarea>
                <button id="loadPastedDataBtn" class="mt-2 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">Load Data</button>
            </div>
        </div>
    </div>

    <!-- Main Application Content -->
    <div id="main-content" class="max-w-4xl mx-auto" style="visibility: hidden;">
        <div class="bg-white rounded-xl shadow-lg mb-6 p-4 no-print">
            <div class="flex flex-wrap justify-end items-center gap-2 mb-3">
                 <button id="generateHandoffBtn" type="button" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-3 rounded-lg text-sm">ðŸ“‹ Copy Bedside Notes</button>
                 <button id="addPatientBtn" type="button" class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-3 rounded-lg text-sm">Add Patient</button>
                 <button id="printBlankBtn" type="button" class="bg-gray-100 text-gray-800 hover:bg-gray-200 font-semibold py-2 px-3 rounded-lg text-sm">Print Blank Form</button>
                 <button id="clearDataBtn" type="button" class="bg-red-100 text-red-800 hover:bg-red-200 font-semibold py-2 px-3 rounded-lg text-sm">Clear All Data</button>
            </div>
            <div id="patientTabsContainer" class="patient-tabs-container flex flex-wrap items-center"></div>
        </div>

        <form id="assessmentForm" onsubmit="return false;">
            <div class="bg-white rounded-xl shadow-lg mb-6 overflow-hidden">
                <div class="header-gradient p-6 flex items-center justify-center text-white">
                    <h1 class="text-2xl sm:text-3xl font-bold">ALERT Nursing Risk Assessment Tool</h1>
                </div>
            </div>

            <div id="fullReviewContainer">
                <div class="bg-white rounded-xl shadow-lg mb-6 p-6 space-y-6 print-section">
                    <div class="bg-gray-50 p-4 rounded-lg border">
                        <h3 class="text-lg font-semibold mb-4">Patient & Review Details</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 text-sm">
                            <div class="md:col-span-2"><label for="reviewType" class="block font-medium">Type of Review:</label><select id="reviewType" class="mt-1 w-full rounded-md border-2 p-2"><option value="post">Post-ICU stepdown review</option><option value="pre">Pre-ICU stepdown review</option></select></div>
                            <div><label for="patientInitials" class="block font-medium">Patient Initials:</label><input type="text" id="patientInitials" class="mt-1 w-full rounded-md border-2 p-2"></div>
                            <div><label for="wardAndRoom" class="block font-medium">Ward & Room No.:</label><input type="text" id="wardAndRoom" class="mt-1 w-full rounded-md border-2 p-2"></div>
                            <div id="postStepdownFields" class="grid sm:grid-cols-2 gap-x-6 gap-y-4 md:col-span-2">
                                <div><label for="icuStepdownDate" class="block font-medium">ICU Stepdown Date:</label><input type="date" id="icuStepdownDate" class="mt-1 w-full rounded-md border-2 p-2"></div>
                                <div><label for="icuStepdownTime" class="block font-medium">ICU Stepdown Time-band:</label><select id="icuStepdownTime" class="mt-1 w-full rounded-md border-2 p-2"><option value="Morning (0600-1159)" data-ooh="false">Morning (0600-1159)</option><option value="Afternoon (1200-1759)" data-ooh="false">Afternoon (1200-1759)</option><option value="Evening (1800-2359)" data-ooh="true">Evening (1800-2359)</option><option value="Night (0000-0559)" data-ooh="true">Night (0000-0559)</option></select></div>
                            </div>
                            <div class="md:col-span-2"><label for="losDays" class="block font-medium">ICU LOS (days):</label><input type="number" id="losDays" min="0" class="mt-1 w-full rounded-md border-2 p-2"></div>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg mb-6 p-6 space-y-6 print-hide">
                    <div class="bg-gray-50 p-4 rounded-lg border"><h3 class="text-lg font-semibold mb-4">Clinical Background</h3><div class="space-y-4"><div><label for="goc" class="block text-sm font-medium">Goals of Care:</label><select id="goc" class="mt-1 w-full rounded-md border-2 p-2"><option value="">Not Documented</option><option value="A">A</option><option value="B">B</option><option value="C">C</option></select><div id="gocSpecificsContainer" class="hidden mt-2"><label for="gocSpecifics" class="block text-sm font-medium">Specifics:</label><input type="text" id="gocSpecifics" class="mt-1 w-full rounded-md border-2 p-2"></div></div><div id="allergies-section"><label class="block text-sm font-medium">Allergies:</label><div class="mt-2 space-y-2"><div class="flex items-center"><input type="checkbox" id="nkdaCheckbox" class="h-4 w-4 rounded"><label for="nkdaCheckbox" class="ml-2">No Known Drug Allergies</label></div><div id="allergies_container" class="space-y-2"></div><button type="button" id="addAllergyButton" class="no-print mt-2 text-sm bg-blue-100 px-3 py-1 rounded-md">+ Add Allergy</button></div></div><div><label class="block text-sm font-medium">Infection Control Precautions:</label><div class="mt-2 flex flex-wrap gap-x-4 gap-y-2"><label class="flex items-center"><input type="checkbox" name="precautions" class="precaution-cb" value="Contact"> <span class="ml-2">Contact</span></label><label class="flex items-center"><input type="checkbox" name="precautions" class="precaution-cb" value="Droplet"> <span class="ml-2">Droplet</span></label><label class="flex items-center"><input type="checkbox" name="precautions" class="precaution-cb" value="Airborne"> <span class="ml-2">Airborne</span></label></div><div id="infectionControlDetails" class="hidden mt-2"><label for="infectionControlReason" class="block text-sm font-medium">Reason:</label><input type="text" id="infectionControlReason" class="mt-1 w-full rounded-md border-2 p-2"></div></div></div></div>
                    <div> <h3 class="text-lg font-semibold">Reason for ICU Admission:</h3> <textarea id="admissionReason" rows="3" class="mt-1 w-full rounded-md border-2 p-2"></textarea> </div>
                    <div> <h3 class="text-lg font-semibold">ICU Summary / Timeline:</h3> <textarea id="icuSummary" rows="10" class="mt-1 w-full rounded-md border-2 p-2"></textarea> </div>
                    <div> <h3 class="text-lg font-semibold">Past Medical History (PMH):</h3> <textarea id="pmh" rows="5" class="mt-1 w-full rounded-md border-2 p-2"></textarea> </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg mb-6 p-6 print-hide">
                    <div id="bloods-container" class="bg-gray-50 p-4 rounded-lg border"></div>
                </div>
                <div class="bg-white rounded-xl shadow-lg mb-6 p-6 print-hide">
                    <div id="adds-container" class="bg-gray-50 p-4 rounded-lg border"></div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-lg mb-6 p-6 print-section">
                <div id="scoringContainer">
                    <h2 class="text-xl font-bold border-b pb-3 mb-4">RISK SCORING ASSESSMENT</h2>
                    <!-- Scoring options will be injected here by JS -->
                </div> 
            </div>

            <div id="fullReviewContainerBottom">
                <div class="bg-white rounded-xl shadow-lg mb-6 p-6 print-hide">
                    <details class="bg-gray-50 p-4 rounded-lg border" open><summary class="font-semibold cursor-pointer">Device, Drain & Wound Assessment</summary><div class="space-y-6 pt-4"><div><h4 class="font-medium">CVADs</h4><div id="central_lines_container" class="space-y-2"></div><button type="button" id="addCentralLineButton" class="no-print mt-2 text-sm bg-rose-100 px-3 py-1 rounded-md">+ Add CVAD</button></div><div class="mt-4 pt-4 border-t"><h4 class="font-medium">PIVCs</h4><div id="pivcs_container"  class="space-y-2"></div><button type="button" id="addPivcButton" class="no-print mt-2 text-sm bg-blue-100 px-3 py-1 rounded-md">+ Add PIVC</button></div><details class="pt-4 border-t"><summary class="text-sm font-medium">Show Additional</summary><div class="space-y-6 pt-4"><div><h4 class="font-medium">IDC</h4><div id="idcs_container" class="space-y-2"></div><button type="button" id="addIdcButton" class="no-print mt-2 text-sm bg-gray-100 px-3 py-1 rounded-md">+ Add IDC</button></div><div class="mt-4 pt-4 border-t"><h4 class="font-medium">Other Devices & Wounds</h4><div id="others_container" class="space-y-2"></div><button type="button" id="addOtherButton" class="no-print mt-2 text-sm bg-gray-100 px-3 py-1 rounded-md">+ Add Other</button></div></div></details></div></details>
                </div>
                <div class="bg-white rounded-xl shadow-lg mb-6 p-6 space-y-6 print-hide">
                    <h2 class="text-xl font-bold border-b pb-3">Final Assessment & Plan</h2>
                    <div class="bg-gray-50 p-4 rounded-lg border"><h3 class="font-semibold mb-2">Fluid Balance</h3><div class="grid md:grid-cols-2 gap-4"><div><label class="block text-sm font-medium">24hr Fluid Balance (mL)</label><input type="number" id="fbc_24hr_input" class="mt-1 w-full rounded-md border-2 p-2" step="100"></div><div><label class="block text-sm font-medium">Total ICU Balance (mL)</label><input type="number" id="fbc_total_input" class="mt-1 w-full rounded-md border-2 p-2" step="100"></div></div></div>
                    <div><h3 class="text-lg font-semibold mb-2">PICS</h3><div class="p-4 rounded-lg bg-purple-50"><div class="space-y-2"><div class="segmented-control"><label class="score-option"><input type="radio" name="pics_status" value="Negative" checked><span class="option-label">Negative</span></label><label class="score-option"><input type="radio" name="pics_status" value="Positive"><span class="option-label">Positive</span></label><label class="score-option"><input type="radio" name="pics_status" value="Unable to assess"><span class="option-label">Unable to assess</span></label></div><div id="pics_details_container" class="hidden pt-2"><label for="pics_notes" class="block text-sm font-medium">Plan:</label><textarea id="pics_notes" rows="2" class="mt-1 w-full rounded-md border-2 p-2" placeholder="Plan..."></textarea></div></div></div></div>
                    <div><label class="flex items-center font-medium"><input type="checkbox" id="homeTeamPlanCheckbox" class="mr-2 h-4 w-4">Home Team Plan in Place</label><div id="homeTeamPlanDetails" class="hidden mt-2"><textarea id="homeTeamPlanText" rows="3" class="mt-1 w-full rounded-md border-2 p-2" placeholder="Enter plan details..."></textarea></div></div>
                    <div><label for="generalNotes" class="block font-medium">General Notes (for handoff & summary):</label><textarea id="generalNotes" rows="6" class="mt-1 w-full rounded-md border-2 p-2" placeholder="Use this single field for all free-text notes during a two-device workflow. On desktop, use the specific fields above."></textarea></div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-lg mt-6 p-6">
                <div class="final-score-bg text-white rounded-xl shadow-lg p-6 mb-6">
                    <div class="flex flex-col sm:flex-row justify-between items-center text-center">
                        <div class="mb-4 sm:mb-0"><span class="text-lg font-medium text-gray-400">Final Score</span><div id="updatedTotalScore" class="text-5xl font-bold">0</div></div>
                        <div class="w-full sm:w-auto"><span class="text-lg font-medium text-gray-400">FINAL CATEGORY & ACTION</span><div id="updatedRiskCategory" class="text-xl font-bold p-3 rounded-md mt-1">Enter data</div></div>
                    </div>
                </div>
                <h2 class="text-xl font-bold border-b pb-3 mb-4">DMR Summary Generator</h2>
                <div class="flex space-x-4 mb-4 no-print">
                    <button type="button" id="generateSummaryButton" class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded-lg w-1/2">Generate</button>
                    <button type="button" id="copySummaryButton" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg w-1/2">Copy</button>
                </div>
                <textarea id="emrSummary" rows="25" class="w-full p-2 border rounded-md bg-gray-50 font-mono text-xs" placeholder="Your summary will appear here..."></textarea>
                <div class="mt-6 text-center no-print"><button type="button" id="resetButton" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg">Reset Form</button></div>
            </div>
        </form>
    </div>
    
    <div class="text-center mt-8 text-gray-500 text-sm no-print">Version 12.0.0 - Final Workflow</div>
    
    <script src="main.js"></script>

</body>
</html>

