<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICU Readmission Prevention Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="launchScreenModal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-lg shadow-xl max-w-md w-full text-center">
            <h1 class="text-2xl font-bold mb-4">ICU Readmission Prevention Tool</h1>
            <p class="text-gray-600 mb-6">A lean, evidence-based risk engine.</p>
            <button id="startNewReviewBtn" class="bg-teal-500 text-white px-4 py-2 rounded mb-4 w-full">âž• Start New Review</button>
            <button id="resumeReviewBtn" class="bg-blue-500 text-white px-4 py-2 rounded w-full">ðŸ“² Continue from Desktop (Paste handoff key)</button>
            <div id="pasteContainer" class="mt-4 hidden">
                <textarea id="pasteDataInput" class="w-full p-2 border rounded" placeholder="Paste handoff key here..."></textarea>
                <button id="loadPastedDataBtn" class="bg-green-500 text-white px-4 py-2 rounded mt-2 w-full">Load Data</button>
            </div>
        </div>
    </div>

    <div id="main-content" class="container mx-auto p-4 max-w-4xl" style="visibility: hidden;">
        <header class="header-gradient text-white p-4 rounded-t-lg">
            <div class="flex justify-between items-center">
                <h1 class="text-xl font-bold">Acute Risk Engine</h1>
                <button id="startOverBtn" class="bg-red-500 text-white px-2 py-1 rounded">Start Over</button>
            </div>
        </header>

        <form id="assessmentForm" class="bg-white shadow-md rounded-b-lg p-6 space-y-8">
            <!-- Patient & Clinical Context -->
            <section id="patient-context-section">
                <h2 class="form-section-title">Patient & Clinical Context</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <label>Patient Initials:<input type="text" id="patient_initials" class="input-field" required></label>
                    <label>URN (Last 4):<input type="text" id="patient_urn_last4" class="input-field" required></label>
                    <label>Ward:<input type="text" id="ward" class="input-field" required></label>
                    <label>Room No.:<input type="text" id="room_number" class="input-field"></label>
                </div>
                <details class="context-details mt-4">
                    <summary>Add Clinical Context (Optional)</summary>
                    <div class="space-y-4">
                        <label>Goals of Care (GOC):
                            <select id="goc" class="input-field">
                                <option>For full resuscitation</option>
                                <option>Medical treatment, not for ICU</option>
                                <option>Palliative</option>
                            </select>
                        </label>
                        <label>Reason for ICU Admission:<textarea id="reason_icu" class="input-field"></textarea></label>
                        <label>Past Medical History (PMH):<textarea id="pmh" class="input-field"></textarea></label>
                    </div>
                </details>
            </section>

             <!-- Bloods Section -->
            <section id="bloods-section">
                <h2 class="form-section-title">Bloods</h2>
                <div class="domain-container">
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
                        <label>Lactate:<input type="number" step="0.1" id="lactate" class="input-field" min="0" required><select id="lactate_trend" class="input-field mt-1"><option>stable</option><option>improving</option><option>worsening</option></select></label>
                        <label>Creatinine (Current):<input type="number" id="creatinine" class="input-field" min="0" required><select id="creatinine_trend" class="input-field mt-1"><option>stable</option><option>improving</option><option>worsening</option></select></label>
                        <label>Creatinine (Baseline):<input type="number" id="creatinine_baseline" class="input-field" min="0" required></label>
                        <label>Platelets:<input type="number" id="platelets" class="input-field" min="0" required><select id="platelets_trend" class="input-field mt-1"><option>stable</option><option>improving</option><option>worsening</option></select></label>
                        <label>Albumin:<input type="number" id="albumin" class="input-field" min="0"><select id="albumin_trend" class="input-field mt-1"><option>stable</option><option>improving</option><option>worsening</option></select></label>
                        <label>Bilirubin:<input type="number" id="bilirubin" class="input-field" min="0"><select id="bilirubin_trend" class="input-field mt-1"><option>stable</option><option>improving</option><option>worsening</option></select></label>
                        <label>CRP:<input type="number" id="crp" class="input-field" min="0"><select id="crp_trend" class="input-field mt-1"><option>stable</option><option>improving</option><option>worsening</option></select></label>
                        <label>WBC:<input type="number" id="wbc" class="input-field" min="0"><select id="wbc_trend" class="input-field mt-1"><option>stable</option><option>improving</option><option>worsening</option></select></label>
                        <label>Hb:<input type="number" id="hb" class="input-field" min="0"><select id="hb_trend" class="input-field mt-1"><option>stable</option><option>improving</option><option>worsening</option></select></label>
                    </div>
                </div>
            </section>
            
            <!-- Desktop Entry Section -->
            <section id="desktop-entry-section" class="text-center p-4 bg-blue-50 rounded-lg">
                <h2 class="text-lg font-semibold text-blue-800">Ready for Bedside Assessment?</h2>
                <p class="text-sm text-blue-700 my-2">You have entered the pre-review data. To continue on your mobile, click the button below to copy the handoff key.</p>
                <button type="button" id="generateHandoffBtn" class="bg-blue-500 text-white px-4 py-2 rounded">ðŸ“² Copy Data Key to Mobile</button>
            </section>


            <!-- Context, Devices & Frailty -->
            <section id="context-frailty-section">
                <h2 class="form-section-title">Context, Devices & Frailty</h2>
                <div class="space-y-4">
                    <div class="flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-4">
                        <label class="flex items-center"><input type="checkbox" id="context_discharge" class="input-checkbox"> Out-of-Hours Discharge</label>
                        <label class="flex items-center"><input type="checkbox" id="context_ward" class="input-checkbox"> Ward Capacity/Capability Mismatch</label>
                    </div>
                    <label class="flex items-center"><input type="checkbox" id="frailty_impression" class="input-checkbox"> Clinical Impression of Frailty / Low Reserve</label>
                    <label>Frailty Score (Rockwood CFS 1-9):<input type="number" id="frailty_score" class="input-field" min="1" max="9"></label>
                    <label class="flex items-center"><input type="checkbox" id="complex_device" class="input-checkbox"> Complex Device Present (CVC, Chest Drain, etc.)</label>
                    <label>List Devices (for DMR):<textarea id="device_list" class="input-field"></textarea></label>
                </div>
            </section>

            <!-- A-E Assessment -->
            <section id="assessment-container">
                <h2 class="form-section-title">A-E Assessment</h2>
                <div class="space-y-6">
                    <div><h3 class="assessment-section-title">A: Airway</h3><select id="airway_input" class="input-field"><option value="Clear">Clear and maintained</option><option value="At Risk">Airway at risk / requires adjunct</option></select></div>
                    <div><h3 class="assessment-section-title">B: Breathing</h3><div class="assessment-grid"><label>Oâ‚‚ Device:<select id="resp_device" class="input-field"><option value="RA">Room Air</option><option value="NP">Nasal Prongs</option><option value="HF">High-Flow</option><option value="NIV">NIV/CPAP</option></select></label><label>Oâ‚‚ Trend:<select id="resp_trend" class="input-field"><option value="stable">Stable</option><option value="worsening">Worsening</option></select></label><label>Resp Rate:<input type="number" id="rr" class="input-field" min="0" required></label><label>SpO2 (%):<input type="number" id="spo2" class="input-field" min="0" max="100" required></label></div></div>
                    <div><h3 class="assessment-section-title">C: Circulation</h3><div class="assessment-grid"><label>Heart Rate:<input type="number" id="hr" class="input-field" min="0" required></label><label>Systolic BP:<input type="number" id="sbp" class="input-field" min="0" required></label></div></div>
                    <div><h3 class="assessment-section-title">D: Disability</h3><div class="assessment-grid"><label>Consciousness:<select id="neuro_consciousness" class="input-field"><option>Alert</option><option>Voice</option><option>Pain</option><option>Unresponsive</option></select></label><label>Delirium Present:<select id="neuro_delirium" class="input-field"><option value="no">No</option><option value="yes">Yes</option></select></label></div></div>
                    <div><h3 class="assessment-section-title">E: Exposure</h3><label>Temperature (Â°C):<input type="number" step="0.1" id="temp" class="input-field" min="0" required></label></div>
                </div>
                <div class="mt-6 bg-teal-50 p-4 rounded-lg border border-teal-200 text-center">
                    <span class="text-sm font-medium text-gray-500">CALCULATED ADDS SCORE</span>
                    <div id="finalADDSScore" class="font-bold text-5xl my-2">0</div>
                </div>
            </section>

            <!-- Manual Override -->
            <section>
                <h2 class="form-section-title">Manual Override</h2>
                <label class="flex items-center"><input type="checkbox" id="override_checkbox" class="input-checkbox"> Escalate Category Due to Clinical Concern</label>
                <label>Override Reason:<textarea id="override_reason" class="input-field"></textarea></label>
            </section>
        </form>

        <!-- Output Panel -->
        <div id="output-panel" class="mt-8 bg-white shadow-md rounded-lg p-6" style="display: none;">
            <h2 class="text-xl font-bold mb-4">Assessment Summary</h2>
            <div id="summary-container"></div>
        </div>

        <!-- DMR Summary -->
        <div class="mt-8">
            <h2 class="form-section-title">DMR Summary Generator</h2>
            <button type="button" id="generateSummaryButton" class="bg-green-500 text-white px-4 py-2 rounded">Generate & Copy to Clipboard</button>
            <textarea id="emrSummary" class="w-full mt-4 p-2 border rounded" style="display: none;" rows="20"></textarea>
        </div>
    </div>

    <!-- Sticky Footer -->
    <div id="sticky-footer" class="fixed bottom-0 left-0 right-0 p-2 shadow-lg transition-colors duration-300 flex items-center justify-center z-40 category-green">
        <span id="footer-category" class="font-bold text-lg">LOW RISK</span>
    </div>
    <script src="js/script.js"></script>
</body>
</html>

